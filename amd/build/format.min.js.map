{"version":3,"file":"format.min.js","sources":["../src/format.js"],"sourcesContent":["// Javascript functions for Sections course format.\n\nM.course = M.course || {};\n\nM.course.format = M.course.format || {};\n\n/**\n * Get sections config for this format.\n *\n * The section structure is:\n * <ul class=\"sections\">\n *  <li class=\"section\">...</li>\n *  <li class=\"section\">...</li>\n *   ...\n * </ul>\n *\n * @return {object} section list configuration\n */\nM.course.format.get_config = function() {\n    return {\n        container_node: 'ul',\n        container_class: 'sections',\n        section_node: 'li',\n        section_class: 'section'\n    };\n};\n\n/**\n * Swap section.\n *\n * @param {YUI} Y YUI3 instance\n * @param {string} node1 node to swap to\n * @param {string} node2 node to swap with\n */\nM.course.format.swap_sections = function(Y, node1, node2) {\n    var CSS = {\n        COURSECONTENT: 'course-content',\n        SECTIONADDMENUS: 'section_add_menus'\n    };\n\n    var sectionlist = Y.Node.all('.' + CSS.COURSECONTENT + ' ' + M.course.format.get_section_selector(Y));\n    // Swap the non-ajax menus, noting these are not always present (depends on theme and user prefs).\n    if (sectionlist.item(node1).one('.' + CSS.SECTIONADDMENUS)) {\n        sectionlist.item(node1).one('.' + CSS.SECTIONADDMENUS).swap(sectionlist.item(node2).one('.' + CSS.SECTIONADDMENUS));\n    }\n};\n\n/**\n * Process sections after ajax response.\n *\n * @param {YUI} Y YUI3 instance\n * @param {NodeList} sectionlist of sections\n * @param {array} response ajax response\n * @param {string} sectionfrom first affected section\n * @param {string} sectionto last affected section\n */\nM.course.format.process_sections = function(Y, sectionlist, response, sectionfrom, sectionto) {\n    var CSS = {\n        SECTIONNAME: 'sectionname'\n    },\n    SELECTORS = {\n        SECTIONLEFTSIDE: '.left .section-handle .icon'\n    };\n\n    if (response.action == 'move') {\n        // If moving up swap around 'sectionfrom' and 'sectionto' so the that loop operates.\n        if (sectionfrom > sectionto) {\n            var temp = sectionto;\n            sectionto = sectionfrom;\n            sectionfrom = temp;\n        }\n\n        // Update titles and move icons in all affected sections.\n        var ele, str, stridx, newstr;\n\n        for (var i = sectionfrom; i <= sectionto; i++) {\n            // Update section title.\n            var content = Y.Node.create('<span>' + response.sectiontitles[i] + '</span>');\n            sectionlist.item(i).all('.' + CSS.SECTIONNAME).setHTML(content);\n            // Update the drag handle.\n            ele = sectionlist.item(i).one(SELECTORS.SECTIONLEFTSIDE).ancestor('.section-handle');\n            str = ele.getAttribute('title');\n            stridx = str.lastIndexOf(' ');\n            newstr = str.substr(0, stridx + 1) + i;\n            ele.setAttribute('title', newstr);\n            // Update the aria-label for the section.\n            sectionlist.item(i).setAttribute('aria-label', content.get('innerText').trim());\n        }\n    }\n};\n"],"names":["M","course","format","get_config","container_node","container_class","section_node","section_class","swap_sections","Y","node1","node2","CSS","sectionlist","Node","all","get_section_selector","item","one","swap","process_sections","response","sectionfrom","sectionto","SELECTORS","action","temp","ele","str","stridx","newstr","i","content","create","sectiontitles","setHTML","ancestor","getAttribute","lastIndexOf","substr","setAttribute","get","trim"],"mappings":"AAEAA,EAAEC,OAASD,EAAEC,QAAU,GAEvBD,EAAEC,OAAOC,OAASF,EAAEC,OAAOC,QAAU,GAcrCF,EAAEC,OAAOC,OAAOC,WAAa,iBAClB,CACHC,eAAgB,KAChBC,gBAAiB,WACjBC,aAAc,KACdC,cAAe,YAWvBP,EAAEC,OAAOC,OAAOM,cAAgB,SAASC,EAAGC,MAAOC,WAC3CC,kBACe,iBADfA,oBAEiB,oBAGjBC,YAAcJ,EAAEK,KAAKC,IAAI,IAAMH,kBAAoB,IAAMZ,EAAEC,OAAOC,OAAOc,qBAAqBP,IAE9FI,YAAYI,KAAKP,OAAOQ,IAAI,IAAMN,sBAClCC,YAAYI,KAAKP,OAAOQ,IAAI,IAAMN,qBAAqBO,KAAKN,YAAYI,KAAKN,OAAOO,IAAI,IAAMN,uBAatGZ,EAAEC,OAAOC,OAAOkB,iBAAmB,SAASX,EAAGI,YAAaQ,SAAUC,YAAaC,eAC3EX,gBACa,cAEjBY,0BACqB,iCAGE,QAAnBH,SAASI,OAAkB,IAEvBH,YAAcC,UAAW,KACrBG,KAAOH,UACXA,UAAYD,YACZA,YAAcI,aAIdC,IAAKC,IAAKC,OAAQC,OAEbC,EAAIT,YAAaS,GAAKR,UAAWQ,IAAK,KAEvCC,QAAUvB,EAAEK,KAAKmB,OAAO,SAAWZ,SAASa,cAAcH,GAAK,WACnElB,YAAYI,KAAKc,GAAGhB,IAAI,IAAMH,iBAAiBuB,QAAQH,SAIvDH,QADAD,KADAD,IAAMd,YAAYI,KAAKc,GAAGb,IAAIM,2BAA2BY,SAAS,oBACxDC,aAAa,UACVC,YAAY,KACzBR,OAASF,IAAIW,OAAO,EAAGV,OAAS,GAAKE,EACrCJ,IAAIa,aAAa,QAASV,QAE1BjB,YAAYI,KAAKc,GAAGS,aAAa,aAAcR,QAAQS,IAAI,aAAaC"}